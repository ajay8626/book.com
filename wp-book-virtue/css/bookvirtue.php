<?phpglobal $wpdb;session_start();$alphabet 	 = "";$virtueimage = "";$virtue 	 = "";$priority 	 = "";$code 		 = "";$gender 	 = "";if(isset($_POST['submit']) && isset($_POST['alphabet']) && isset($_POST['virtue']) && $_POST['alphabet']!='' && $_POST['virtue']!=''){	$alphabet 		= isset($_POST['alphabet'])		?	strtoupper($_POST['alphabet'])		:	"";	$virtueimage	= isset($_POST['virtueimage'])	?	$_POST['virtueimage']	:	"";	$virtue 		= isset($_POST['virtue'])		?	strtoupper($_POST['virtue'])		:	"";	$priority 		= isset($_POST['priority'])		?	$_POST['priority']		:	"";	$code 			= isset($_POST['code'])			?	$_POST['code']			:	"";	$gender 		= isset($_POST['gender'])		?	$_POST['gender']		:	"";		if($_POST['submit'] == 'Save'){		if($alphabet != "" && $virtueimage != "" && $virtue != "" && $priority != ""){			$wpdb->insert(				'wp_book_virtue',				array(					'id'			=> NULL,					'alphabet'		=> $alphabet,					'virtue'		=> $virtue,					'image'			=> $virtueimage,					'priority'		=> $priority,					'virtue_code'	=> $code,					'gender'		=> $gender				)			);			$_SESSION['msg'] = 'Virtue added successfully.';			$virtue_id = $wpdb->insert_id;			wp_redirect("admin.php?page=book_virtue&virtue_id=".$virtue_id);			exit;		}	}		if($_POST['submit'] == 'Upload'){		if($alphabet != "" && $virtueimage != "" && $virtue != "" && $priority != "" && isset($_REQUEST['virtue_id']) && $_REQUEST['virtue_id'] !=""){		$virtue_id = $_REQUEST['virtue_id'];					$wpdb->query(				$wpdb->prepare(					"UPDATE wp_book_virtue SET 					alphabet = '$alphabet', 					virtue = '$virtue', 					image = '$virtueimage', 					priority = '$priority', 					virtue_code = '$code', 					gender = '$gender' 					WHERE id = $virtue_id"				)			);			$_SESSION['msg'] = 'Virtue updated successfully.';			wp_redirect("admin.php?page=book_virtue&virtue_id=".$virtue_id);			exit;		}	}	}if(isset($_REQUEST['virtue_id']) && $_REQUEST['virtue_id'] !=""){	$virtue_id = $_REQUEST['virtue_id'];	$sql = "SELECT * FROM wp_book_virtue WHERE id = $virtue_id";	$result = $wpdb->get_results($sql) or die(mysql_error());	foreach($result as $res){		$alphabet 	 = $res->alphabet;		$virtueimage = $res->image;		$virtue 	 = $res->virtue;		$priority 	 = $res->priority;		$code 		 = $res->virtue_code;		$gender 	 = $res->gender;	}}?>
<div role="main" id="wpbody">	<div tabindex="0" aria-label="Main content" id="wpbody-content">		<div class="wrap">			<h1 class="wp-heading-inline">Book Virtue</h1><a href="admin.php?page=book_virtue" class="page-title-action">Add New</a>			<br><br>			<?php echo isset($_SESSION['msg'])?$_SESSION['msg']:""; ?>			<div class="option">				<form name="bookvirtueform" action="" method="POST" enctype="multipart/form-data">					<table class="form-table virtue-table">						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="alphabet">Alphabet</label></th>							<td><input type="text" id="alphabet" name="alphabet" value="<?php echo $alphabet; ?>" maxlength="1" class="regular-text" required /></td>						</tr>						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="image">Image</label></th>							<td><input id="virtueimage" type="hidden" name="virtueimage" value="<?php if($virtueimage != ''){ ?><?php echo $virtueimage; ?><?php } ?>" /><input class="onetarek-upload-button button staff_button" type="button" value="Upload Image" /></td>						</tr>						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="virtue">Virtue</label></th>							<td><input type="text" id="virtue" name="virtue" value="<?php echo $virtue; ?>" class="regular-text" maxlength="30" required /></td>						</tr>						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="priority">Priority</label></th>							<td><input type="number" id="priority" name="priority" value="<?php echo $priority; ?>" maxlength="4"  min="0" class="regular-text" required/></td>						</tr>						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="priority">Code</label></th>							<td><input type="text" id="code" name="code" value="<?php echo $code; ?>" maxlength="8" class="regular-text"/></td>						</tr>						<tr class="user-rich-editing-wrap">							<th scope="row"><label for="boy">Gender</label></th>							<td>								<fieldset>									<legend class="screen-reader-text"><span>Gender</span></legend>									<label for="boy"><input name="gender" type="radio" id="boy" value="0" <?php if($gender == 0){ echo "checked"; } ?>>Boy</label>								</fieldset>								<fieldset>									<label for="girl"><input name="gender" type="radio" id="girl" value="1" <?php if($gender == 1){ echo "checked"; } ?>>Girl</label>								</fieldset>							</td>						</tr>					</table>					<div class="sidebar-image">						<img id="imgadd" src="<?php if($virtueimage != ''){ ?><?php echo $virtueimage; ?><?php }else{ echo plugins_url().'/wp-book-virtue/noimage.png'; } ?>" alt="Virtue Image" />					</div>					<?php if(isset($_REQUEST['virtue_id']) && $_REQUEST['virtue_id'] !=""){ ?>						<p class="submit"><input type="submit" name="submit" id="submit" class="button button-primary" value="Upload"></p>					<?php }else{ ?>						<p class="submit"><input type="submit" name="submit" id="submit" class="button button-primary" value="Save"></p>					<?php } ?>				</form>				
			</div>
		</div>
	</div>
</div>